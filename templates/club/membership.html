{% extends "base.html" %}
{% load static %}


{% block content %}
<main class="max-w-5xl mx-auto px-4 py-12">
  <!-- Page heading -->
  <section class="text-center mb-10">
    <h1 class="text-3xl md:text-4xl font-bold mb-3">
      Join the Heritage Tomato Club
    </h1>
    <p class="text-base md:text-lg text-base-content/80 max-w-2xl mx-auto">
      Choose a membership tier that fits your tomato-growing journey – 
      from curious seedling to dedicated heritage keeper.
    </p>
  </section>

  <!-- Pricing grid -->
  <section class="grid gap-6 md:grid-cols-3">
    {# ---------- FREE TIER(S) ---------- #}
    {% for tier in free_tiers %}
      <article class="card bg-base-100 shadow-xl border border-base-300">
        <div class="card-body">
          <h2 class="card-title flex items-center justify-between">
            {{ tier.name }}
            <span class="badge badge-outline">Free</span>
          </h2>

          {% if tier.short_tagline %}
            <p class="text-sm text-base-content/80">
              {{ tier.short_tagline }}
            </p>
          {% else %}
            <p class="text-sm text-base-content/80">
              A gentle way to dip your toes into the world of heritage tomatoes.
              Always free, no card required.
            </p>
          {% endif %}

          <p class="mt-4">
            <span class="text-3xl font-bold">£0</span>
            <span class="text-sm text-base-content/70">/ year</span>
          </p>

          {% if tier.feature_list %}
            <ul class="mt-4 space-y-2 text-sm">
              {% for line in tier.feature_list.splitlines %}
                {% if line %}
                  <li class="flex gap-2 items-start">
                    <span class="mt-1 inline-block w-2 h-2 rounded-full bg-success"></span>
                    {{ line }}
                  </li>
                {% endif %}
              {% endfor %}
            </ul>
          {% endif %}

          <div class="card-actions mt-6">
            <a
              href="{% url 'account_signup' %}"
              class="btn btn-outline btn-primary w-full"
            >
              Join for free
            </a>
          </div>
        </div>
      </article>
    {% endfor %}

    {# ---------- PAID TIER(S) ---------- #}
    {% for tier in paid_tiers %}
      {# Highlight the first paid tier as 'Most popular' #}
      <article class="
        card bg-base-100
        {% if forloop.first %}
          shadow-2xl border-2 border-primary relative
        {% else %}
          shadow-xl border border-base-300
        {% endif %}
      ">
        {% if forloop.first %}
          <div class="absolute -top-3 inset-x-0 flex justify-center">
            <span class="badge badge-primary badge-lg shadow-md">
              Most popular
            </span>
          </div>
        {% endif %}

        <div class="card-body {% if forloop.first %}pt-8{% endif %}">
          <h2 class="card-title flex items-center justify-between">
            {{ tier.name }}
            <span class="badge badge-outline badge-primary">
              Seed drops by post
            </span>
          </h2>

          {% if tier.short_tagline %}
            <p class="text-sm text-base-content/80">
              {{ tier.short_tagline }}
            </p>
          {% else %}
            <p class="text-sm text-base-content/80">
              For home growers who want real seeds in the post plus deeper
              access to the club’s resources.
            </p>
          {% endif %}

          <p class="mt-4">
            <span class="text-3xl font-bold">£{{ tier.price_per_year }}</span>
            <span class="text-sm text-base-content/70">/ year</span>
          </p>

          {% if tier.feature_list %}
            <ul class="mt-4 space-y-2 text-sm">
              {% for line in tier.feature_list.splitlines %}
                {% if line %}
                  <li class="flex gap-2 items-start">
                    <span class="mt-1 inline-block w-2 h-2 rounded-full bg-success"></span>
                    {{ line }}
                  </li>
                {% endif %}
              {% endfor %}
            </ul>
          {% endif %}

          <div class="card-actions mt-6">
            <button
              type="button"
              class="btn {% if forloop.first %}btn-primary{% else %}btn-outline btn-accent{% endif %} w-full join-tier-btn"
              data-tier-slug="{{ tier.slug }}"
              data-checkout-url-template="{% url 'club:membership_checkout' slug='__SLUG__' %}"
            >
              Join {{ tier.name }}
            </button>
          </div>

        </div>
      </article>
    {% endfor %}
  </section>

  <!-- Small reassurance / seed timing text -->
  <section class="mt-10 text-center text-sm text-base-content/70 space-y-1">
    <p>
      Seed drops are planned for the UK sowing season – typically 
      <strong>December to March</strong>, depending on variety and availability.
    </p>
    <p>
      You can upgrade or downgrade between tiers as the club grows. 
      During the early stages, some perks may roll out gradually.
    </p>
  </section>
</main>

<script src="https://js.stripe.com/v3/"></script>
<script defer src="{% static 'js/membership.js' %}"></script>


{% endblock content %}
